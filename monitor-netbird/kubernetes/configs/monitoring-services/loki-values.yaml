loki:
  deploymentMode: Distributed
  
  loki:
    auth_enabled: false

    storage:
      type: gcs
      bucketNames:
        chunks: <LOKI_CHUNKS_BUCKET_NAME> # Replace with your Loki chunks bucket name
        ruler: <LOKI_RULER_BUCKET_NAME> # Replace with your Loki ruler bucket name
        admin: <LOKI_ADMIN_BUCKET_NAME> # Replace with your Loki admin bucket name
      gcs:
        chunkBufferSize: 0
        requestTimeout: "0s"
        enableHttp2: true
    
    commonConfig:
      replication_factor: 1
      path_prefix: /var/loki
    
    schemaConfig:
      configs:
        - from: <LOKI_SCHEMA_FROM_DATE>
          store: tsdb
          object_store: gcs
          schema: v13
          index:
            prefix: loki_index_
            period: 24h
    
    limits_config:
      retention_period: 720h
      reject_old_samples: true
      reject_old_samples_max_age: 168h
      ingestion_rate_mb: 100
      ingestion_burst_size_mb: 200
      per_stream_rate_limit: 50MB
      per_stream_rate_limit_burst: 100MB
      max_entries_limit_per_query: 100000
      max_streams_per_user: 0
      allow_structured_metadata: true
      volume_enabled: true
    
    pattern_ingester:
      enabled: true
    
    ruler:
      enable_api: true
      storage:
        type: gcs
        gcs:
          bucket_name: <LOKI_RULER_BUCKET_NAME> # Replace with your Loki ruler bucket name
    
    ingester:
      chunk_encoding: snappy
    
    compactor:
      working_directory: /var/loki/compactor 
      compaction_interval: 10m
      retention_enabled: true
      retention_delete_delay: 2h
      retention_delete_worker_count: 150
      delete_request_store: gcs
    
    analytics:
      reporting_enabled: false
  
  serviceAccount:
    create: false
    name: observability-sa
    annotations:
      iam.gke.io/gcp-service-account: <GCP_SERVICE_ACCOUNT_EMAIL> # Replace with your GCP service account email
  
  singleBinary:
    replicas: 0
    persistence:
      enabled: true             
      size: 5Gi                
      storageClass: standard-rwo
    affinity: {}
    
  gateway:
    enabled: true
    replicas: 2
    maxUnavailable: 1
    service:
      type: ClusterIP
      port: 80
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        external-dns.alpha.kubernetes.io/hostname: loki.<YOUR_MONITORING_DOMAIN> # Replace with your Loki domain name (e.g., loki.yourdomain.com)
    affinity: {}
  
  backend:
    replicas: 0
  read:
    replicas: 0
  write:
    replicas: 0
  ingester:
    replicas: 2
    maxUnavailable: 1
  querier:
    replicas: 2
    maxUnavailable: 1
  queryFrontend:
    replicas: 2
    maxUnavailable: 1
  queryScheduler:
    replicas: 2
    maxUnavailable: 1
  distributor:
    replicas: 2
    maxUnavailable: 1
  compactor:
    replicas: 1
  indexGateway:
    replicas: 2
    maxUnavailable: 1
  bloomCompactor:
    replicas: 0
  bloomGateway:
    replicas: 0
  
  chunksCache:
    enabled: true
  resultsCache:
    enabled: true
  
  minio:
    enabled: false
  
  test:
    enabled: false
  
  monitoring:
    selfMonitoring:
      enabled: false
      grafanaAgent:
        installOperator: false
    lokiCanary:
      enabled: false
