prometheus:
  alertmanager:
    enabled: false
  kube-state-metrics:
    enabled: true
  prometheus-node-exporter:
    enabled: false
  prometheus-pushgateway:
    enabled: false
  serviceAccount:
  annotations:
    iam.gke.io/gcp-service-account: <GCP_SERVICE_ACCOUNT_EMAIL>
  
  server:
    persistentVolume:
      enabled: true
      size: 3Gi
    retention: 7d
    service:
      type: ClusterIP
      port: 80
      targetPort: 9090
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        external-dns.alpha.kubernetes.io/hostname: prometheus.<YOUR_MONITORING_DOMAIN>
    resources:
      requests:
        memory: 2Gi
        cpu: 500m
      limits:
        memory: 4Gi
        cpu: 1000m
    global:
      evaluation_interval: 15s
      scrape_interval: 15s
      external_labels:
        cluster: <CLUSTER_NAME>
        environment: <ENVIRONMENT>
    
    remoteWrite:
      - url: http://monitoring-stack-mimir-nginx:80/api/v1/push
        queue_config:
          capacity: 10000
          max_shards: 200
          min_shards: 1
          max_samples_per_send: 5000
          batch_send_deadline: 5s
          min_backoff: 30ms
          max_backoff: 5s
  
  # Depending on your Loki setup, you may need to scrape different endpoints
  extraScrapeConfigs: |
  
    - job_name: loki
      metrics_path: /metrics
      static_configs:
        - targets: 
          - 'monitoring-stack-loki-distributor:3100'
          - 'monitoring-stack-loki-ingester-zone-a-headless:3100'
          - 'monitoring-stack-loki-ingester-zone-b-headless:3100'
          - 'monitoring-stack-loki-ingester-zone-c-headless:3100'
          - 'monitoring-stack-loki-querier:3100'
          - 'monitoring-stack-loki-query-frontend:3100'
          - 'monitoring-stack-loki-compactor:3100'
          - 'monitoring-stack-loki-index-gateway:3100'
          - 'monitoring-stack-loki-query-scheduler:3100'
          labels:
            instance: 'loki'
            cluster: 'k8s'
    
    - job_name: grafana
      static_configs:
        - targets: ['monitoring-stack-grafana:80']
          labels:
            instance: 'grafana'
            cluster: 'k8s'
    
    - job_name: mimir-distributor
      static_configs:
        - targets: ['monitoring-stack-mimir-distributor:8080']
          labels:
            instance: 'mimir-distributor'
            cluster: 'k8s'
    
    - job_name: tempo
      static_configs:
        - targets: ['monitoring-stack-tempo-query-frontend:3200']
          labels:
            instance: 'tempo'
            cluster: 'k8s'