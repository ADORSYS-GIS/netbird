tempo:
  replicas: 1
  
  tempo:
    auth_enabled: false
    
    server:
      http_listen_port: 3200
      grpc_listen_port: 9095
      log_level: info
    
    storage:
      trace:
        backend: local
        # PRODUCTION: Use object storage
        # backend: s3
        # s3:
        #   bucket: tempo-traces
        #   endpoint: s3.amazonaws.com
        #   region: us-east-1
        #   access_key: ${S3_ACCESS_KEY}
        #   secret_key: ${S3_SECRET_KEY}
        local:
          path: /var/tempo/traces
        wal:
          path: /var/tempo/wal
    
    receivers:
      jaeger:
        protocols:
          thrift_http:
            endpoint: 0.0.0.0:14268
          grpc:
            endpoint: 0.0.0.0:14250
          thrift_binary:
            endpoint: 0.0.0.0:6832
          thrift_compact:
            endpoint: 0.0.0.0:6831
      zipkin:
        endpoint: 0.0.0.0:9411
      otlp:
        protocols:
          http:
            endpoint: 0.0.0.0:4318
          grpc:
            endpoint: 0.0.0.0:4317
      opencensus:
        endpoint: 0.0.0.0:55678
    
    ingester:
      trace_idle_period: 10s
      max_block_bytes: 1000000
      max_block_duration: 5m
    
    compactor:
      compaction:
        block_retention: 720h
    
    queryFrontend:
      search:
        duration_slo: 5s
        throughput_bytes_slo: 1073741824
    
    global_overrides:
      max_bytes_per_trace: 5000000
    
    retention: 720h
  
  persistence:
    enabled: true
    size: 3Gi
    # PRODUCTION: Use storageClassName
    # storageClassName: gp3
  
  service:
    type: ClusterIP

  # Ingress is now handled by ingress-resources.yaml
  # This centralizes all ingress configuration for easier management

  serviceMonitor:
    enabled: false
  
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi
  
  # PRODUCTION: Increase resources
  # resources:
  #   limits:
  #     cpu: 2000m
  #     memory: 4Gi
  #   requests:
  #     cpu: 500m
  #     memory: 1Gi
  
  # Pod-level security context
  podSecurityContext:
    fsGroup: 10001
  
  # Container-level security context
  securityContext:
    runAsUser: 10001
    runAsGroup: 10001
    runAsNonRoot: true
  
  affinity: {}
  
  env:
    - name: GOMEMLIMIT
      value: "900MiB"
    # PRODUCTION: Increase memory limit
    # - name: GOMEMLIMIT
    #   value: "3600MiB"